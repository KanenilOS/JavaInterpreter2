<h3 style="text-align: center;">
Міністерство Освіти і Науки України</h3>
<h3 style="text-align: center;">
Тернопільський національний технічний університет імені Івана Пулюя</h3>

<br><br><br>

<p style="text-align: right;">
Факультет комп’ютерно-інформаційних систем</p>
<p style="text-align: right;">
та програмної інженерії</p>
<p style="text-align: right;">
Кафедра “Програмної інженерії”</p>

<br><br><br><br>

<h2 style="text-align: center; font-weight: bold;">
ЗВІТ
</h2>

<p style="text-align: center;">
З лабораторної роботи №3</p>
<p style="text-align: center;">
на тему: "Написання інтерпретатора мови програмування"</p>
<p style="text-align: center;">
З дисципліни:</p>
<p style="text-align: center;">
"Конструювання програмного забезпечення"</p>

<br><br><br><br><br><br><br><br>

<p style="text-align: right;">
Виконав:</p>
<p style="text-align: right;">
ст. гр. СП-31</p>
<p style="text-align: right;">
Бурда О.Б.</p>

<br><br>

<p style="text-align: center;">
Тернопіль 2024</p>

<!--Page Break-->
<div style="page-break-after: always;"></div>

## Мета
Метою цієї роботи є набути навичок з розробки інтерпретаторів та компліяторів мов програмування

## Огляд
Інтерпретатор призначений для розбору та виконання простої мови програмування. Архітектура є модульною і складається з компонентів, відповідальних за лексичний аналіз, синтаксичний аналіз та виконання в середовищі виконання.

## Лексичний Аналізатор
Лексичний аналізатор, реалізований в пакеті `org.interpreter.lexer`, відповідає за токенізацію вхідного коду.

#### Класи
- **BasicLexer**
    - **Обов'язки**: Токенізує вхідний код у об'єкти `Token`.
    - **Методи**:
        - `nextToken()`: Повертає наступний токен з вхідного коду.
        - `reset()`: Скидає лексичний аналізатор на початок вхідних даних.

- **Command**
    - **Обов'язки**: Перелічує команди, які розуміє лексичний та синтаксичний аналізатор.
    - **Методи**:
        - `fromString(String commandStr)`: Перетворює строкове представлення команди у відповідну константу енумератора `Command`.

## Синтаксичний Аналізатор
Синтаксичний аналізатор, реалізований в пакеті `org.interpreter.parser`, обробляє токени з лексичного аналізатора для побудови абстрактного синтаксичного дерева (AST) та генерує список об'єктів `Statement`.

#### Класи
- **Parser**
    - **Обов'язки**: Розбирає токени у вирази та керуючі структури, такі як цикли та умовні оператори.
    - **Методи**:
        - `parse()`: Розбирає весь вхідний код та повертає список виразів.
        - Інші методи для розбору конкретних конструкцій (наприклад, `parseStatement()`, `parseExpression()`).

- **Вирази**
    - **AdditionExpression**
    - **DivisionExpression**
    - **EqualityExpression**
    - **ModulusExpression**
    - **MultiplicationExpression**
    - **NumericExpression**
    - **RelationalExpression**
    - **StringExpression**
    - **SubtractionExpression**

- **Вирази**
    - **AssignmentStatement**
    - **ForStatement**
    - **GoToStatement**
    - **IfStatement**
    - **InputStatement**
    - **PrintStatement**
    - **Statement**

### Середовище Виконання
Середовище виконання, реалізоване в пакеті `org.interpreter.runtime`, керує виконанням програмного коду, включаючи зберігання змінних та обробку підпрограм.

### Класи
- **RuntimeEnvironment**
    - **Обов'язки**: Керує станом змінних та підпрограм під час виконання.
    - **Методи**:
        - `registerLabel(String label, List<Statement> statements)`: Реєструє підпрограму з її міткою та виразами.
        - `goToLabel(String label)`: Повертає список виразів для вказаної мітки підпрограми.
        - `setVariable(String name, Object value)`: Встановлює значення змінної в середовищі виконання.
        - `getVariable(String name)`: Повертає значення змінної з середовища виконання.

### Винятки
Винятки, реалізовані в пакеті `org.interpreter.exceptions`, обробляють помилки виконання та надають зрозумілі повідомлення про помилки.

#### Класи
- **InterpreterRuntimeException**
- **UninitializedSubroutineException**
- **UninitializedVariableException**

## Збірка проекту

Проект збирається за допомогою Gradle.

**Компіляція коду**: Для збірки проекту та його запуску з терміналу виконуємо наступні команди.

	gradlew build
	gradlew run

**Тестування**: Для виконання тестів з терміналу виконуємо настпуну команду.

	gradlew test

## Тестування

Тести були виконані за допомогою бібліотеки JUnit. Тести знаходяться в директорії [test](src/test/java).
Було покрито тестами більшу частину дій та виразів.

Загалом є 40 тестів, по 20 на Expression вирази та Statement вирази.

## Робочий процес
1. **Обробка Входу**: Клас `Main` зчитує шлях до файлу від користувача.
2. **Лексичний Аналіз**: `BasicLexer` токенізує вхідний код.
3. **Синтаксичний Аналіз**: `Parser` обробляє токени у абстрактне синтаксичне дерево та генерує список виразів `Statement`.
4. **Виконання**: `RuntimeEnvironment` керує станом змінних та виконує вирази.

## JavaDoc документація
Було додано для кожного класу, методу, змінній документацію, що дає можливість її згенерувати з IDE.

## Діаграма класів
За допомогою можливостей IntelliJ IDEA 2023.1.1 (Ultimate Edition), вдалось згенерувати наступну діаграму класів:

![](https://kanenil.bsite.net/uploads/Lab-3.png)

